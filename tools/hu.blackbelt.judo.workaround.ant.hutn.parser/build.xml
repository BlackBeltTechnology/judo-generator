<?xml version="1.0" encoding="UTF-8"?>
<project default="build">
	<property name="target.dir" location="target-ant" />

	<property name="hutn.file.location" location="../../engine//hu.blackbelt.judo.generator.transformer.psm/src/model/test_car.hutn" />
	<property name="psm.meta.location" location="../../engine//hu.blackbelt.judo.generator.meta.psm/model/psm.ecore" />
	<property name="psm.types.location" location="../../engine/hu.blackbelt.judo.generator.meta.psm/library/psmTypes.model" />
	<property name="transformed.model.name" value="transformedModelFromAnt.model" />
	<property name="transformed.base.dir" value="${target.dir}" />
	<property name="psm.meta.uri" value="http://blackbelt.hu/judo/meta/psm" />

	<property name="dep.jar.file" location="../../engine/hu.blackbelt.judo.generator.third.party/lib/ant/epsilon-ant/epsilon-1.4-kitchensink.jar" />
	<property name="_src.dir" location="src/main/java" />
	<property name="classes.dir" location="${target.dir}/classes" />
	<property name="jar.name" value="hutnTomodelParser.jar" />
	<property name="main.class.name" value="hu.blackbelt.judo.workaround.ant.hutn.parser.Main" />

	<path id="classpath">
		<fileset file="${dep.jar.file}"/>
	</path>
	
	<target name="build">
		<delete dir="${target.dir}" failonerror="false" />
		<mkdir dir="${target.dir}" />
		<mkdir dir="${classes.dir}" />

		<javac srcdir="${_src.dir}" destdir="${classes.dir}" >
			<classpath refid="classpath" />
		</javac>

		<jar destfile="${target.dir}/${jar.name}" basedir="${classes.dir}" />

	</target>

	<target name="run" depends="build">
		<java fork="true" classname="${main.class.name}" failonerror="true">
			<!--jvmarg line="-XX:+UnlockCommercialFeatures -XX:+FlightRecorder -XX:+UnlockDiagnosticVMOptions -XX:FlightRecorderOptions=defaultrecording=true,dumponexit=true,dumponexitpath=jmcStatistics.jfr"/-->
			<classpath>
				<path refid="classpath" />
				<pathelement location="${target.dir}/${jar.name}"/>
			</classpath>
			<arg value="${hutn.file.location}"/>
			<arg value="${transformed.base.dir}"/>
			<arg value="${transformed.model.name}"/>
			<arg value="${psm.meta.uri}"/>
			<arg value="${psm.meta.location}"/>
			<arg value="${psm.types.location}"/>
		</java>
	</target>

</project>